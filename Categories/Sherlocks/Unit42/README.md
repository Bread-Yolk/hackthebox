# Unit42
> Write-up author: jon-brandy

![image](https://github.com/jon-brandy/hackthebox/assets/70703371/920cd552-7e29-4191-a309-d9601e97ad76)


## Lessons Learned:
- Reviewing sysmon logs using Event Viewer.

## SCENARIO:
In this Sherlock, you will familiarize yourself with Sysmon logs and various useful EventIDs for identifying and analyzing malicious activities on a Windows system. 
Palo Alto's Unit42 recently conducted research on an UltraVNC campaign, wherein attackers utilized a backdoored version of UltraVNC to maintain access to systems. 
This lab is inspired by that campaign and guides participants through the initial access stage of the campaign.


## STEPS:
1. In this challenge, we're tasked to analyze malicious act on a Windows system by reviewing a Windows Event Log file which contains sysmon logs.

![image](https://github.com/jon-brandy/hackthebox/assets/70703371/c450b9d7-bf21-4e10-b6d9-4efe9409f5ee)


#### NOTES:

```
Sysmon (System Monitor) logs are a type of log generated by the Sysinternals Sysmon utility, which is a Windows system
service and device driver thatprovides advanced system monitoring and logging capabilities. Sysmon logs capture
detailed information about various activities happening on a Windows system, including process creation,
network connections, file creation, registry modifications, and more.
```

2. To analyze this type of log file we can use **Event Viewer**.

> Result in Event Viewer


![image](https://github.com/jon-brandy/hackthebox/assets/70703371/c644bf5d-2d78-4d65-b2b7-c280f2da5f89)


> 1ST QUESTION --> ANS: 56

![image](https://github.com/jon-brandy/hackthebox/assets/70703371/0208a2b3-6758-4887-8462-36387ffc08bb)


3. There are 2 ways to identify the total logs for EventID 11. The first one is by filtering the log displayed in EventViewer then count it manually.


![image](https://github.com/jon-brandy/hackthebox/assets/70703371/61294a7b-87c2-4d0d-a1bf-7a9009798214)


4. Or, simply execute this powershell command.

> COMMAND

```ps
Get-WinEvent -Path '.\Microsoft-Windows-Sysmon-Operational.evtx' -FilterXPath "*[System[(EventID=11)]]" | Measure-Object
```

> THE RESULT OF PS COMMAND


![image](https://github.com/jon-brandy/hackthebox/assets/70703371/b684310b-a9fb-4fc4-8803-eabd8140ef53)


> 2ND QUESTION --> ANS:

![image](https://github.com/jon-brandy/hackthebox/assets/70703371/f05510da-8da4-4658-a6ab-2ff24e46529e)


> 3RD QUESTION --> ANS:

![image](https://github.com/jon-brandy/hackthebox/assets/70703371/d3eff909-9df2-488a-a056-3454a52532eb)


> 4TH QUESTION --> ANS:

![image](https://github.com/jon-brandy/hackthebox/assets/70703371/dbcf19b4-6c90-49d9-9f46-77025d4a9c9f)


> 5TH QUESTION --> ANS:

![image](https://github.com/jon-brandy/hackthebox/assets/70703371/289a5892-5062-454b-be9c-7884c3c2fd54)


> 6TH QUESTION --> ANS:

![image](https://github.com/jon-brandy/hackthebox/assets/70703371/dec896fd-5771-427e-83a8-ef78d6b92d23)


> 7TH QUESTION --> ANS:


![image](https://github.com/jon-brandy/hackthebox/assets/70703371/f47bba48-7d38-4fce-95ca-c987ddb59368)


> 8TH QUESTION --> ANS:


![image](https://github.com/jon-brandy/hackthebox/assets/70703371/c00f492c-812c-422a-8ca1-608a74e0d4ed)

